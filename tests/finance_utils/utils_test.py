import pytest

from testing_utils.finance_utils.utils import get_lists_evenly_spaced_samples


@pytest.mark.parametrize(
    ("list_of_items", "long_count", "short_count", "expected_result"),
    [
        (["2024-01-01"], 1, 0, (["2024-01-01"], [])),
        (["2024-01-01"], 0, 1, ([], ["2024-01-01"])),
        (["2024-01-01", "2024-01-02"], 1, 1, (["2024-01-01"], ["2024-01-02"])),
        (
            ["2024-01-01", "2024-01-02", "2024-01-03"],
            2,
            1,
            (["2024-01-01", "2024-01-03"], ["2024-01-02"]),
        ),
        (
            ["2024-01-01", "2024-01-02", "2024-01-03"],
            1,
            2,
            (["2024-01-02"], ["2024-01-01", "2024-01-03"]),
        ),
        (
            ["2024-01-01", "2024-01-02", "2024-01-03", "2024-01-04"],
            2,
            2,
            (["2024-01-01", "2024-01-03"], ["2024-01-02", "2024-01-04"]),
        ),
        (
            ["2024-01-01", "2024-01-02", "2024-01-03", "2024-01-04", "2024-01-05"],
            3,
            2,
            (["2024-01-01", "2024-01-03", "2024-01-05"], ["2024-01-02", "2024-01-04"]),
        ),
        (
            ["2024-01-01", "2024-01-02", "2024-01-03", "2024-01-04", "2024-01-05"],
            2,
            3,
            (["2024-01-02", "2024-01-04"], ["2024-01-01", "2024-01-03", "2024-01-05"]),
        ),
        (
            [
                "2024-01-01",
                "2024-01-02",
                "2024-01-03",
                "2024-01-04",
                "2024-01-05",
                "2024-01-08",
            ],
            1,
            2,
            (["2024-01-03"], ["2024-01-01", "2024-01-05"]),
        ),
        (
            [
                "2024-01-01",
                "2024-01-02",
                "2024-01-03",
                "2024-01-04",
                "2024-01-05",
                "2024-01-08",
                "2024-01-09",
            ],
            1,
            2,
            (["2024-01-03"], ["2024-01-01", "2024-01-05"]),
        ),
        (
            [
                "2024-01-01",
                "2024-01-02",
                "2024-01-03",
                "2024-01-04",
                "2024-01-05",
                "2024-01-08",
                "2024-01-09",
                "2024-01-10",
            ],
            1,
            2,
            (["2024-01-03"], ["2024-01-01", "2024-01-08"]),
        ),
        (
            [
                "2024-01-01",
                "2024-01-02",
                "2024-01-03",
                "2024-01-04",
                "2024-01-05",
                "2024-01-08",
                "2024-01-09",
                "2024-01-10",
                "2024-01-11",
            ],
            1,
            2,
            (["2024-01-04"], ["2024-01-01", "2024-01-09"]),
        ),
    ],
)
def test_success(list_of_items, long_count, short_count, expected_result):
    assert (
        get_lists_evenly_spaced_samples(list_of_items, long_count, short_count)
        == expected_result
    )


@pytest.mark.parametrize(
    ("list_of_items", "long_count", "short_count"),
    [
        ([], 1, 1),
        (["2024-01-01"], 0, 0),
        (["2024-01-01"], -1, 1),
        (["2024-01-01"], 1, -1),
        (["2024-01-01"], 0, 2),
        (["2024-01-01"], 2, 0),
        (["2024-01-01"], 1, 3),
        (["2024-01-01"], 3, 1),
        (["2024-01-01"], 10, 13),
        (["2024-01-01"], 13, 10),
        (["2024-01-01", "2024-01-02"], 1, 2),
        (["2024-01-01", "2024-01-02"], 2, 1),
    ],
)
def test_error(list_of_items, long_count, short_count):
    with pytest.raises(ValueError):
        get_lists_evenly_spaced_samples(
            list_of_items,
            long_count,
            short_count,
        )
